Not written for public use, will need modification to use yourself
